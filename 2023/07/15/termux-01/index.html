<!DOCTYPE html><html lang="cn" theme-mode="auto"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>termux使用记录 | Ark-Blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light' || window.matchMedia('(prefers-color-scheme:light)').matches) document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark' || window.matchMedia('(prefers-color-scheme:dark)').matches) document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/independent/"><span class="navItemTitle">独立页面</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>termux使用记录</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-07-15T10:20:35.000Z" id="date"> 2023-07-15</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-07-16T06:54:34.951Z" id="updated"> 2023-07-16</time></div></span><br><span>文章总字数: <div class="control">999</div></span><br><span>预计阅读时间: <div class="control">4 分钟</div></span></div></div><hr><div id="post-content"><h1 id="前言：一次日记"><a href="#前言：一次日记" class="headerlink" title="前言：一次日记"></a>前言：一次日记</h1><p>我与初次认识termux大概是在上初中那会，当时termux还处于不冷不热的状态，最后还是在国光大佬写的一篇关于termux文章下系统的学习了相关的知识，这次经历可谓是对我的后来乃至现在都受益匪浅（因为当时没有电脑，只有手机），这篇文章涉及了很多程序语言，例如java，python，go…..等等，还有linux系统的相关指令，是及其优秀的一篇文章，当然这还有许多</p>
<span id="more"></span>

<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.sqlsec.com/2018/05/termux.html#Termux-%E7%AE%80%E4%BB%8B">国光大佬的原文地址</a></p>
</blockquote>
<h1 id="termux利用python爬取b站并入库"><a href="#termux利用python爬取b站并入库" class="headerlink" title="termux利用python爬取b站并入库"></a>termux利用python爬取b站并入库</h1><p>首先保证 mysql 与 python3 完整安装，在 termux中 mysql 安装可用 pkg install mariadb<br>命令安装。</p>
<h1 id="termux中mariabd的基本配置可以参考官方文档"><a href="#termux中mariabd的基本配置可以参考官方文档" class="headerlink" title="termux中mariabd的基本配置可以参考官方文档"></a>termux中mariabd的基本配置可以参考官方文档</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://wiki.termux.com/wiki/MariaDB">termux官方文档</a><br><a target="_blank" rel="noopener" href="https://mariadb.org/documentation/">mariadb官方文档</a></p>
</blockquote>
<h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#启动mysql服务（得到一个进程号（pid号），nohup: ignoring input and appending output to `nohup.out&#x27;提示也是正常的）</span><br>nohup mysqld &amp;<br><br><span class="hljs-comment">#进入mysql(whoami为本机的登陆名)</span><br>mysql -u $&#123;whoami&#125;<br><br><span class="hljs-comment">#mysql内修改root密码，我这里习惯设置用户名密码都为root</span><br>use mysql;<br><span class="hljs-built_in">set</span> password <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> = password(<span class="hljs-string">&#x27;root&#x27;</span>);<br><br><span class="hljs-comment"># 刷新权限</span><br>flush privileges;<br><br><span class="hljs-comment"># 创建数据库</span><br>create database bilidb;<br>use bilidb;<br>CREATE TABLE `hot` (<br>  `<span class="hljs-built_in">id</span>` <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) NOT NULL AUTO_INCREMENT,<br>  `hotword` varchar(<span class="hljs-number">200</span>) CHARACTER SET utf8 DEFAULT NULL,<br>  PRIMARY KEY (`<span class="hljs-built_in">id</span>`),<br>  UNIQUE KEY `hotword` (`hotword`)<br>) ENGINE=InnoDB AUTO_INCREMENT=<span class="hljs-number">67</span> DEFAULT CHARSET=latin1;<br><br><span class="hljs-comment">#退出mysql</span><br>quit;<br><br><span class="hljs-comment">#需要关闭mysql服务可以掉进程</span><br>kill -<span class="hljs-number">9</span> PID(这个pid号启动服务的时候回显示)<br></code></pre></td></tr></table></figure>

<h1 id="运行python程序"><a href="#运行python程序" class="headerlink" title="运行python程序"></a>运行python程序</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python +文件名</span><br>例子：python hello-world.py<br><br><span class="hljs-comment"># 注意，部分手机受安卓11系统应用文件的限制，termux可能无法访问其他文件目录的文件，所以建议将需要的文件放在termux当下的目录位置</span><br></code></pre></td></tr></table></figure>

<h1 id="编写爬虫程序"><a href="#编写爬虫程序" class="headerlink" title="编写爬虫程序"></a>编写爬虫程序</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python程序</span><br><span class="hljs-comment">#字典</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> pymysql.cursors<br><br><br><span class="hljs-comment">#加头标识</span><br>headers = &#123;<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.77 Safari/537.36&#x27;</span><br>&#125;<br><br>product=[]<br><span class="hljs-comment">#获取传回数据</span><br>resp=requests.get(<span class="hljs-string">&#x27;https://s.search.bilibili.com/main/hotword?mid=&amp;buvid=98E676EF-F586-403E-8440-52A6836FA68713451infoc&amp;jsonp=jsonp&amp;callback=jsonCallback_bili_58910703464582290&#x27;</span>,headers=headers)<br><br>rest=resp.text.replace(<span class="hljs-string">&#x27;jsonCallback_bili_58910703464582290(&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-comment">#转换json键值对</span><br><br>json_data=json.loads(rest)<br><br>comments=json_data[<span class="hljs-string">&quot;list&quot;</span>]<br><span class="hljs-comment">#     #把想要的数据装入列表中</span><br>proDict=[]<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> comments:<br>    proDict.append(item[<span class="hljs-string">&#x27;keyword&#x27;</span>]+<span class="hljs-string">&#x27; &#x27;</span>)<br>product.extend(proDict)<br><br><span class="hljs-comment"># 把数组里所有数据都转入字符串中（这里是学习用的，可以去除）</span><br>p=<span class="hljs-string">&#x27;&#x27;</span>.join(proDict)<br><br><span class="hljs-built_in">print</span>(p)<br><br><br><span class="hljs-comment"># 数据入库</span><br><span class="hljs-comment"># 连接数据库</span><br>conn = pymysql.connect(<br>          host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<br>          port=<span class="hljs-number">3306</span>,<br>          user=<span class="hljs-string">&#x27;root&#x27;</span>,<br>          passwd=<span class="hljs-string">&#x27;root&#x27;</span>,<br>          db=<span class="hljs-string">&#x27;bilidb&#x27;</span>,<br>          charset=<span class="hljs-string">&#x27;utf8&#x27;</span>,<br>          cursorclass=pymysql.cursors.Cursor,<br>         )<br><br>cur=conn.cursor()<br><span class="hljs-comment">#这里用replace解决数据入库时重复数据的问题，注意hotword字段要设置唯一约束</span><br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> proDict:<br>        cur.execute(<span class="hljs-string">&quot;replace into hot(hotword) values(&#x27;%s&#x27;)&quot;</span> %(item))<br><span class="hljs-comment">#事务提交（这里尝试性的用了一个异常处理，嘿嘿可以去掉）</span><br><span class="hljs-keyword">try</span>:      <br>    conn.commit()<br><span class="hljs-keyword">except</span> AttributeError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;错误&quot;</span>)<br>cur.close()<br><br></code></pre></td></tr></table></figure>
<p>注：最上面的 import &lt;模块名称&gt;，中引入的模块需要确保已经安装，否则会出现模块缺失报错</p>
<p>写完了代码，记住你保存的文件名<br>在 termux 中依次输入下面两条命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">nohup mysqld &amp;<br><br>python &lt;保存的文件名&gt;<br></code></pre></td></tr></table></figure>

<h1 id="在termux中加入定时任务，每分钟爬一次入库"><a href="#在termux中加入定时任务，每分钟爬一次入库" class="headerlink" title="在termux中加入定时任务，每分钟爬一次入库"></a>在termux中加入定时任务，每分钟爬一次入库</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#安装crontab</span><br>pkg install crontab<br><span class="hljs-comment">#启动服务</span><br>crond<br><span class="hljs-comment">#编辑定时任务</span><br>crontab -e<br><span class="hljs-comment">#输入定时任务</span><br>* * * * * python bili.py &gt;&gt;<span class="hljs-number">123.</span>log<br>星号分别表示 分 时 天 月份 周 可以指定时间运行，若为星号就代表每分或每周或每时...运行，我这里是每分钟运行一次，若要每天则要确定具体时间即 <span class="hljs-number">0</span> <span class="hljs-number">8</span> * * * 这就表示每天<span class="hljs-number">8</span>点运行（后面具体复杂操作见https://www.runoob.com/linux/linux-comm-crontab.html）<br>然后后面就是指令了，***注意的是后面必须要指定一个log文件***，不然它不会运行.<br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/15/ryujinx-log/">ryujinx模拟器日志 Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="valine-sel"></button></div><div id="valine"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="文章目录">≡</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/2.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/ark2005">Dr.A_ZY</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/ark2005"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:3095607272@qq.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/492018974"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A%E4%B8%80%E6%AC%A1%E6%97%A5%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">前言：一次日记</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#termux%E5%88%A9%E7%94%A8python%E7%88%AC%E5%8F%96b%E7%AB%99%E5%B9%B6%E5%85%A5%E5%BA%93"><span class="toc-number">2.</span> <span class="toc-text">termux利用python爬取b站并入库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#termux%E4%B8%ADmariabd%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">termux中mariabd的基本配置可以参考官方文档</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">过程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%90%E8%A1%8Cpython%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.</span> <span class="toc-text">运行python程序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%88%AC%E8%99%AB%E7%A8%8B%E5%BA%8F"><span class="toc-number">6.</span> <span class="toc-text">编写爬虫程序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8termux%E4%B8%AD%E5%8A%A0%E5%85%A5%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%AF%8F%E5%88%86%E9%92%9F%E7%88%AC%E4%B8%80%E6%AC%A1%E5%85%A5%E5%BA%93"><span class="toc-number">7.</span> <span class="toc-text">在termux中加入定时任务，每分钟爬一次入库</span></a></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {new Valine({
 el: '#valine'
 , appId: 'R2jxWC4kTFMWYsS1ZOTRDk2l-MdYXbMMI'
 , appKey: 'txz4BmQLOcuOTFlkLQ2qW9u1', serverURLs: 'https://r2jxwc4k.api.lncldglobal.com' , placeholder: '此条评论委托企鹅物流发送'
 , path: window.location.pathname
});code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>